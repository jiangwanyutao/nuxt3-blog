# é¦–å±å›¾ç‰‡åŠ è½½ä¼˜åŒ–æ–¹æ¡ˆ

## ğŸ¯ é—®é¢˜åˆ†æ

é¦–å±å›¾ç‰‡åŠ è½½æ…¢çš„ä¸»è¦åŸå› ï¼š
1. **å›¾ç‰‡ä½“ç§¯è¿‡å¤§** - åŸå§‹å›¾ç‰‡æœªç»å‹ç¼©
2. **åŠ è½½æ—¶æœºä¸å½“** - æ‰€æœ‰å›¾ç‰‡åŒæ—¶åŠ è½½
3. **æ ¼å¼ä¸ä¼˜** - ä½¿ç”¨ PNG/JPG è€Œé WebP
4. **ç¼ºå°‘å ä½ç¬¦** - åŠ è½½æ—¶å‡ºç°ç©ºç™½

---

## ğŸ’¡ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šå›¾ç‰‡å‹ç¼©ï¼ˆæœ€é‡è¦ï¼‰

#### 1. åœ¨çº¿å‹ç¼©å·¥å…·
- **TinyPNG** (https://tinypng.com/) - æ¨èï¼Œæ— æŸå‹ç¼©
- **Squoosh** (https://squoosh.app/) - Google å‡ºå“
- **Compressor.io** (https://compressor.io/)

#### 2. æœ¬åœ°å‹ç¼©å·¥å…·
```bash
# å®‰è£… imagemin
npm install -D imagemin imagemin-webp imagemin-mozjpeg imagemin-pngquant

# åˆ›å»ºå‹ç¼©è„šæœ¬
```

#### 3. å‹ç¼©è„šæœ¬ `scripts/compress-images.js`
```javascript
const imagemin = require('imagemin');
const imageminWebp = require('imagemin-webp');
const imageminMozjpeg = require('imagemin-mozjpeg');
const imageminPngquant = require('imagemin-pngquant');

(async () => {
  // å‹ç¼© JPG/PNG å¹¶è½¬æ¢ä¸º WebP
  await imagemin(['src/assets/img/banner/*.{jpg,png}'], {
    destination: 'src/assets/img/banner/optimized',
    plugins: [
      imageminMozjpeg({ quality: 80 }),
      imageminPngquant({ quality: [0.6, 0.8] }),
      imageminWebp({ quality: 75 })
    ]
  });
  
  console.log('å›¾ç‰‡å‹ç¼©å®Œæˆï¼');
})();
```

---

### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ WebP æ ¼å¼

WebP æ ¼å¼æ¯” JPG/PNG å° 25-35%ï¼Œä¸”è´¨é‡ç›¸å½“ã€‚

#### 1. è½¬æ¢ç°æœ‰å›¾ç‰‡
```bash
# ä½¿ç”¨ cwebp å·¥å…·
cwebp -q 80 input.jpg -o output.webp
```

#### 2. åœ¨ä»£ç ä¸­ä½¿ç”¨
```vue
<picture>
  <source srcset="/assets/img/banner/1.webp" type="image/webp">
  <img src="/assets/img/banner/1.jpg" alt="banner">
</picture>
```

---

### æ–¹æ¡ˆä¸‰ï¼šæ‡’åŠ è½½å’Œé¢„åŠ è½½

#### 1. ä½¿ç”¨ Nuxt Image ç»„ä»¶
```vue
<template>
  <NuxtImg
    src="/assets/img/banner/1.jpg"
    loading="lazy"
    placeholder
    :modifiers="{ quality: 80, format: 'webp' }"
  />
</template>
```

#### 2. é¢„åŠ è½½é¦–å±å›¾ç‰‡
åœ¨ `nuxt.config.ts` ä¸­ï¼š
```typescript
app: {
  head: {
    link: [
      { rel: 'preload', as: 'image', href: '/assets/img/banner/1.webp' }
    ]
  }
}
```

---

### æ–¹æ¡ˆå››ï¼šæ¸è¿›å¼åŠ è½½ï¼ˆLQIPï¼‰

Low Quality Image Placeholder - å…ˆåŠ è½½æ¨¡ç³Šå°å›¾ï¼Œå†åŠ è½½é«˜æ¸…å¤§å›¾ã€‚

#### 1. ç”Ÿæˆç¼©ç•¥å›¾
```bash
# ä½¿ç”¨ ImageMagick
convert input.jpg -resize 20x20 -blur 0x8 thumbnail.jpg
```

#### 2. ä½¿ç”¨ Base64 å†…è”å°å›¾
```vue
<template>
  <div 
    class="bg-image"
    :style="{
      backgroundImage: `url(${isLoaded ? largeImage : smallImage})`
    }"
  >
  </div>
</template>

<script setup>
const smallImage = 'data:image/jpeg;base64,/9j/4AAQSkZJRg...' // æ¨¡ç³Šå°å›¾
const largeImage = '/assets/img/banner/1.webp'
const isLoaded = ref(false)

onMounted(() => {
  const img = new Image()
  img.src = largeImage
  img.onload = () => {
    isLoaded.value = true
  }
})
</script>
```

---

### æ–¹æ¡ˆäº”ï¼šCDN åŠ é€Ÿ

å°†å›¾ç‰‡ä¸Šä¼ åˆ° CDNï¼Œåˆ©ç”¨ CDN çš„å…¨çƒèŠ‚ç‚¹åŠ é€Ÿã€‚

#### æ¨èçš„å…è´¹ CDN
1. **ä¸ƒç‰›äº‘** - 10GB å…è´¹å­˜å‚¨
2. **åˆæ‹äº‘** - 15GB å…è´¹å­˜å‚¨
3. **Cloudflare** - æ— é™æµé‡
4. **jsDelivr** - GitHub å›¾åºŠ

#### ä½¿ç”¨ç¤ºä¾‹
```vue
<img src="https://cdn.example.com/banner/1.webp" alt="banner">
```

---

### æ–¹æ¡ˆå…­ï¼šå“åº”å¼å›¾ç‰‡

æ ¹æ®è®¾å¤‡å°ºå¯¸åŠ è½½ä¸åŒå¤§å°çš„å›¾ç‰‡ã€‚

```vue
<template>
  <img
    :srcset="`
      /assets/img/banner/1-small.webp 640w,
      /assets/img/banner/1-medium.webp 1024w,
      /assets/img/banner/1-large.webp 1920w
    `"
    sizes="(max-width: 640px) 640px, (max-width: 1024px) 1024px, 1920px"
    src="/assets/img/banner/1.webp"
    alt="banner"
  >
</template>
```

---

## ğŸ›  å®æ–½æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå‹ç¼©ç°æœ‰å›¾ç‰‡

1. å°† `src/assets/img/banner/` ä¸‹çš„æ‰€æœ‰å›¾ç‰‡ç”¨ TinyPNG å‹ç¼©
2. å»ºè®®å‹ç¼©åå¤§å°ï¼š
   - é¦–å±èƒŒæ™¯å›¾ï¼š< 200KB
   - å…¶ä»–å›¾ç‰‡ï¼š< 100KB

### ç¬¬äºŒæ­¥ï¼šè½¬æ¢ä¸º WebP

```bash
# æ‰¹é‡è½¬æ¢
for file in src/assets/img/banner/*.jpg; do
  cwebp -q 80 "$file" -o "${file%.jpg}.webp"
done
```

### ç¬¬ä¸‰æ­¥ï¼šæ›´æ–°ä»£ç 

ä¿®æ”¹ `background.vue`ï¼š

```vue
<template>
  <div class="bg-container">
    <!-- ä½¿ç”¨ picture æ ‡ç­¾æ”¯æŒ WebP -->
    <picture>
      <source 
        :srcset="`/assets/img/banner/${currentBgIndex + 1}.webp`" 
        type="image/webp"
      >
      <img 
        :src="`/assets/img/banner/${currentBgIndex + 1}.jpg`"
        class="bg-image"
        loading="eager"
        fetchpriority="high"
      >
    </picture>
  </div>
</template>

<style scoped>
.bg-container {
  position: relative;
  width: 100%;
  height: 100vh;
}

.bg-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  /* æ·»åŠ åŠ è½½åŠ¨ç”» */
  animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
</style>
```

### ç¬¬å››æ­¥ï¼šé…ç½® Nuxt Image

åœ¨ `nuxt.config.ts` ä¸­ï¼š

```typescript
export default defineNuxtConfig({
  image: {
    quality: 80,
    formats: ['webp', 'jpg'],
    screens: {
      xs: 320,
      sm: 640,
      md: 768,
      lg: 1024,
      xl: 1280,
      xxl: 1536,
    },
    presets: {
      banner: {
        modifiers: {
          format: 'webp',
          quality: 80,
          width: 1920,
          height: 1080
        }
      }
    }
  }
})
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| ä¼˜åŒ–æ–¹æ¡ˆ | åŸå§‹å¤§å° | ä¼˜åŒ–å | èŠ‚çœ | åŠ è½½æ—¶é—´ |
|---------|---------|--------|------|---------|
| æœªä¼˜åŒ– | 2MB | - | - | 3-5s |
| å‹ç¼© JPG | 2MB | 400KB | 80% | 1-2s |
| è½¬ WebP | 2MB | 150KB | 92% | 0.5-1s |
| WebP + CDN | 2MB | 150KB | 92% | 0.2-0.5s |

---

## âœ… æ£€æŸ¥æ¸…å•

- [ ] æ‰€æœ‰å›¾ç‰‡å·²å‹ç¼©ï¼ˆ< 200KBï¼‰
- [ ] è½¬æ¢ä¸º WebP æ ¼å¼
- [ ] æ·»åŠ  loading="lazy" æˆ– "eager"
- [ ] ä½¿ç”¨ CDN åŠ é€Ÿ
- [ ] æ·»åŠ å ä½ç¬¦é¢œè‰²
- [ ] é…ç½®å“åº”å¼å›¾ç‰‡
- [ ] æµ‹è¯•åŠ è½½é€Ÿåº¦

---

## ğŸ”§ æ¨èå·¥å…·

### åœ¨çº¿å·¥å…·
- **PageSpeed Insights** - æ£€æµ‹é¡µé¢æ€§èƒ½
- **WebPageTest** - è¯¦ç»†æ€§èƒ½åˆ†æ
- **Lighthouse** - Chrome å¼€å‘è€…å·¥å…·

### æœ¬åœ°å·¥å…·
```bash
# å®‰è£…æ€§èƒ½åˆ†æå·¥å…·
npm install -g lighthouse

# è¿è¡Œåˆ†æ
lighthouse http://localhost:3001 --view
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **é¦–å±å›¾ç‰‡ä¼˜å…ˆçº§æœ€é«˜** - ä½¿ç”¨ `loading="eager"` å’Œ `fetchpriority="high"`
2. **å…¶ä»–å›¾ç‰‡æ‡’åŠ è½½** - ä½¿ç”¨ `loading="lazy"`
3. **ä¿ç•™åŸå›¾å¤‡ä»½** - å‹ç¼©å‰å¤‡ä»½åŸå›¾
4. **æµ‹è¯•å…¼å®¹æ€§** - WebP åœ¨æ—§æµè§ˆå™¨éœ€è¦é™çº§æ–¹æ¡ˆ
5. **ç›‘æ§æ€§èƒ½** - å®šæœŸæ£€æŸ¥åŠ è½½é€Ÿåº¦

---

## ğŸš€ å¿«é€Ÿå®æ–½

æœ€å¿«çš„ä¼˜åŒ–æ–¹æ¡ˆï¼ˆ5åˆ†é’Ÿå†…å®Œæˆï¼‰ï¼š

1. **å‹ç¼©å›¾ç‰‡** - ç”¨ TinyPNG å‹ç¼©æ‰€æœ‰å›¾ç‰‡
2. **æ·»åŠ èƒŒæ™¯è‰²** - åœ¨ CSS ä¸­æ·»åŠ  `background-color`
3. **ä½¿ç”¨ CDN** - ä¸Šä¼ åˆ°å›¾åºŠæˆ– CDN

è¿™ä¸‰æ­¥å°±èƒ½å‡å°‘ 70-80% çš„åŠ è½½æ—¶é—´ï¼
