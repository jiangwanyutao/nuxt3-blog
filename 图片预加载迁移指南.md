# å›¾ç‰‡é¢„åŠ è½½è¿ç§»æŒ‡å—

## ğŸ“‹ è¿ç§»æ­¥éª¤

### 1. æ‰§è¡Œè¿ç§»è„šæœ¬
```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
.\migrate-images.ps1
```

è¿™ä¼šå°†å›¾ç‰‡ä» `assets` å¤åˆ¶åˆ° `public` ç›®å½•ï¼š
- `src/assets/img/about/*` â†’ `src/public/images/about/*`
- `src/assets/img/banner/*` â†’ `src/public/images/banner/*`

### 2. æ›´æ–°ä»£ç ä¸­çš„å›¾ç‰‡å¼•ç”¨

#### âŒ æ—§çš„å¼•ç”¨æ–¹å¼ï¼ˆassetsï¼‰
```vue
<img src="~/assets/img/about/1.jpg" />
<img :src="require('~/assets/img/banner/1.jpg')" />
```

#### âœ… æ–°çš„å¼•ç”¨æ–¹å¼ï¼ˆpublicï¼‰
```vue
<img src="/images/about/1.jpg" />
<img src="/images/banner/1.jpg" />
```

### 3. æŸ¥æ‰¾éœ€è¦æ›´æ–°çš„æ–‡ä»¶
```powershell
# æœç´¢æ‰€æœ‰å¼•ç”¨äº†è¿™äº›å›¾ç‰‡çš„æ–‡ä»¶
Get-ChildItem -Path "src" -Recurse -Include *.vue,*.ts,*.js | Select-String "assets/img/(about|banner)"
```

## ğŸ¯ é¢„åŠ è½½é…ç½®è¯´æ˜

### nuxt.config.ts å·²é…ç½®
```typescript
link: [
  // About é¡µé¢å›¾ç‰‡ï¼ˆ6å¼ ï¼‰
  { rel: 'preload', href: '/images/about/1.jpg', as: 'image' },
  { rel: 'preload', href: '/images/about/2.jpg', as: 'image' },
  // ... å…¶ä»–å›¾ç‰‡
  
  // Banner å›¾ç‰‡ï¼ˆ8å¼ ï¼‰
  { rel: 'preload', href: '/images/banner/1.jpg', as: 'image' },
  // ... å…¶ä»–å›¾ç‰‡
]
```

### é¢„åŠ è½½æ•ˆæœ
- âœ… æµè§ˆå™¨ä¼šåœ¨é¡µé¢åŠ è½½æ—¶æå‰ä¸‹è½½è¿™äº›å›¾ç‰‡
- âœ… ç”¨æˆ·è®¿é—®ç›¸å…³é¡µé¢æ—¶å›¾ç‰‡ç«‹å³æ˜¾ç¤ºï¼Œæ— éœ€ç­‰å¾…
- âœ… æ”¹å–„é¦–å±åŠ è½½ä½“éªŒ

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### 1. å›¾ç‰‡å¤§å°é—®é¢˜
å½“å‰å›¾ç‰‡æ€»å¤§å°çº¦ **4.8MB**ï¼Œå…¨éƒ¨é¢„åŠ è½½ä¼šå½±å“é¦–å±æ€§èƒ½ï¼

**å»ºè®®ä¼˜åŒ–æ–¹æ¡ˆï¼š**

#### æ–¹æ¡ˆAï¼šåªé¢„åŠ è½½é¦–å±å…³é”®å›¾ç‰‡
```typescript
link: [
  // åªé¢„åŠ è½½é¦–å±å¯è§çš„å›¾ç‰‡
  { rel: 'preload', href: '/images/banner/1.jpg', as: 'image' },
  { rel: 'preload', href: '/images/about/loading-bar.png', as: 'image' }
]
```

#### æ–¹æ¡ˆBï¼šä½¿ç”¨æ‡’åŠ è½½ + é€‰æ‹©æ€§é¢„åŠ è½½
```vue
<!-- é¦–å±å›¾ç‰‡ï¼šé¢„åŠ è½½ -->
<img src="/images/banner/1.jpg" />

<!-- éé¦–å±å›¾ç‰‡ï¼šæ‡’åŠ è½½ -->
<img src="/images/banner/2.jpg" loading="lazy" />
```

#### æ–¹æ¡ˆCï¼šå‹ç¼©å›¾ç‰‡
```powershell
# ä½¿ç”¨ tinypng æˆ–å…¶ä»–å·¥å…·å‹ç¼©å›¾ç‰‡
# ç›®æ ‡ï¼šå°†æ¯å¼ å›¾ç‰‡æ§åˆ¶åœ¨ 100KB ä»¥å†…
```

### 2. è·¯å¾„å¯¹ç…§è¡¨

| æ—§è·¯å¾„ (assets) | æ–°è·¯å¾„ (public) | è®¿é—®URL |
|----------------|----------------|---------|
| `~/assets/img/about/1.jpg` | `src/public/images/about/1.jpg` | `/images/about/1.jpg` |
| `~/assets/img/banner/1.jpg` | `src/public/images/banner/1.jpg` | `/images/banner/1.jpg` |

### 3. æ‰“åŒ…éªŒè¯
```bash
# æ„å»ºé¡¹ç›®
pnpm build

# æ£€æŸ¥è¾“å‡ºç›®å½•
ls .output/public/images/about
ls .output/public/images/banner

# é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬
pnpm preview
```

## ğŸ” éœ€è¦æ›´æ–°çš„å¸¸è§æ–‡ä»¶ä½ç½®

å¯èƒ½éœ€è¦æ›´æ–°å›¾ç‰‡å¼•ç”¨çš„æ–‡ä»¶ï¼š
- `src/pages/about.vue` - About é¡µé¢
- `src/components/Banner.vue` - Banner ç»„ä»¶
- `src/layouts/default.vue` - å¸ƒå±€æ–‡ä»¶
- `src/components/**/*.vue` - å…¶ä»–ç»„ä»¶

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### è¿ç§»å‰ï¼ˆassetsï¼‰
- âŒ å›¾ç‰‡è·¯å¾„å¸¦ hashï¼Œæ— æ³•é¢„åŠ è½½
- âŒ é¦–æ¬¡è®¿é—®éœ€è¦ç­‰å¾…å›¾ç‰‡ä¸‹è½½
- âŒ æ‰“åŒ…åè·¯å¾„ä¸ç¡®å®š

### è¿ç§»åï¼ˆpublic + é¢„åŠ è½½ï¼‰
- âœ… å›ºå®šè·¯å¾„ï¼Œå¯é…ç½®é¢„åŠ è½½
- âœ… æµè§ˆå™¨æå‰ä¸‹è½½å…³é”®å›¾ç‰‡
- âœ… é¦–å±ä½“éªŒæ›´æµç•…
- âš ï¸ éœ€è¦æ³¨æ„é¢„åŠ è½½æ•°é‡ï¼Œé¿å…è¿‡åº¦åŠ è½½

## ğŸ¨ ä¼˜åŒ–å»ºè®®

### 1. å›¾ç‰‡å‹ç¼©ï¼ˆæ¨èï¼‰
```bash
# ä½¿ç”¨ sharp æ‰¹é‡å‹ç¼©
npm install -g sharp-cli
sharp -i "src/public/images/**/*.jpg" -o "src/public/images/" -q 80
```

### 2. ä½¿ç”¨ WebP æ ¼å¼
```bash
# è½¬æ¢ä¸º WebPï¼ˆä½“ç§¯æ›´å°ï¼‰
sharp -i "src/public/images/**/*.jpg" -o "src/public/images/" -f webp
```

### 3. å“åº”å¼å›¾ç‰‡
```vue
<picture>
  <source srcset="/images/banner/1.webp" type="image/webp">
  <img src="/images/banner/1.jpg" alt="Banner">
</picture>
```

## ğŸ“ æ£€æŸ¥æ¸…å•

- [ ] æ‰§è¡Œ `migrate-images.ps1` è¿ç§»å›¾ç‰‡
- [ ] æœç´¢å¹¶æ›´æ–°æ‰€æœ‰å›¾ç‰‡å¼•ç”¨è·¯å¾„
- [ ] æµ‹è¯•å¼€å‘ç¯å¢ƒå›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸
- [ ] æ‰§è¡Œ `pnpm build` æ„å»ºé¡¹ç›®
- [ ] æ£€æŸ¥ `.output/public/images/` ç›®å½•
- [ ] æµ‹è¯•ç”Ÿäº§ç¯å¢ƒå›¾ç‰‡åŠ è½½
- [ ] ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·éªŒè¯é¢„åŠ è½½
- [ ] è€ƒè™‘å›¾ç‰‡å‹ç¼©ä¼˜åŒ–
- [ ] è¯„ä¼°æ˜¯å¦éœ€è¦å‡å°‘é¢„åŠ è½½æ•°é‡

## ğŸš€ å¿«é€Ÿå‘½ä»¤

```powershell
# 1. è¿ç§»å›¾ç‰‡
.\migrate-images.ps1

# 2. æŸ¥æ‰¾éœ€è¦æ›´æ–°çš„æ–‡ä»¶
Get-ChildItem -Path "src" -Recurse -Include *.vue | Select-String "assets/img/(about|banner)"

# 3. æµ‹è¯•æ„å»º
pnpm build

# 4. é¢„è§ˆ
pnpm preview
```
